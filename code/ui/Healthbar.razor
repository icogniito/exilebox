
@inherits Sandbox.UI.Panel
@using Sandbox
@namespace ExileBox

<style>
    Healthbar {
        position: absolute;
        bottom: 0px;
        left: 30%;
        width: 300px;
        height: 70px;
        background-image: url(textures/ui/health/HealthPanel.png); 
        padding: 2px;
    }

    .orbBorderContainer {
        position: absolute;
        bottom: 0px;
        width: 130px;
        height: 130px;
    }

    .orbBorder{
        position: absolute;
        bottom: 0px;
        width: 130px;
        height: 130px;
        background-image: url(textures/ui/health/DarkOrbBorder.png); 
        padding: 2px;
    }

    .orbGlass{
        position: absolute;
        bottom: 5px;
        left: 5px;
        width: 120px;
        height: 120px;
        background-image: url(textures/ui/health/orbHighlight.png); 
        padding: 2px;
    }

    .fill {
        position: absolute;
        bottom: 0px;
        left: 0px;
        width: 100%;
        background-image: url(textures/ui/health/scrollFill.png);
        padding: 2px;
        overflow: hidden;
        transform: rotatex(180deg);
    }
    .fillContainer {
        position: absolute;
        bottom: 5px;
        left: 5px;
        width: 120px;
        height: 120px;
        padding: 2px;
        overflow: hidden;
        border-radius: 50%;
    }
</style>

<root>
    <div class="orbBorderContainer">
        <div class="fillContainer">
            <div class="fill" style="height: @(GetHealth())%"></div>
        </div>
        <div class="orbBorder"></div>
        <div class="orbGlass"></div>
    </div>
</root>

@code {
    public int GetHealth()
    {
        var player = Game.LocalPawn as Pawn;
        if (player == null) return 0;

        return (int)player.Health;
    }

    protected override int BuildHash()
    {
        var currentHealth = GetHealth();

        return currentHealth.GetHashCode();
    }
}